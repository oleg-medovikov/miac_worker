from base import parus_sql

stach_dict = {
    "170716": 'СПб ГБУЗ "Городская поликлиника № 112"',
    "172948": 'СПб ГБУЗ "Городская поликлиника № 17"',
    "178204": 'СПб ГБУЗ "Городская поликлиника № 3"',
    "177268": 'СПб ГБУЗ "Городская поликлиника № 4"',
    "188644": 'СПб ГБУЗ "Городская поликлиника № 52"',
    "183532": 'СПб ГБУЗ "Городская поликлиника № 104"',
    "180364": 'СПб ГБУЗ "Городская поликлиника № 117"',
    "183028": 'СПб ГБУЗ "Городская поликлиника № 14"',
    "182092": 'СПб ГБУЗ "Городская поликлиника № 54"',
    "175756": 'СПб ГБУЗ "Городская поликлиника № 86"',
    "179428": 'СПб ГБУЗ "Городская поликлиника № 96"',
    "178276": 'СПб ГБУЗ "Городская поликлиника № 23"',
    "188284": 'СПб ГБУЗ "Городская поликлиника № 43"',
    "187924": 'СПб ГБУЗ "Городская поликлиника № 88"',
    "178492": 'СПб ГБУЗ "Городская поликлиника № 71"',
    "177700": 'СПб ГБУЗ "Городская поликлиника №107"',
    "179644": 'СПб ГБУЗ "Городская поликлиника № 106"',
    "189148": 'СПб ГБУЗ "Городская поликлиника № 91"',
    "173884": 'СПб ГБУЗ "Городская больница № 40 Курортного района"',
    "172372": 'СПб ГБУЗ "Городская поликлиника № 48"',
    "178060": 'СПб ГБУЗ "Городская поликлиника № 77"',
    "173452": 'СПб ГБУЗ "Городская поликлиника № 122"',
    "179500": 'СПб ГБУЗ "Николаевская больница"',
    "184612": 'СПб ГБУЗ "Городская поликлиника №114"',
    "171364": 'СПб ГБУЗ "Городская поликлиника № 102"',
    "174532": 'СПб ГБУЗ "Городская поликлиника № 49"',
    "175324": 'СПб ГБУЗ "Городская поликлиника № 60"',
    "180796": 'СПб ГБУЗ "Городская поликлиника № 109"',
    "188860": 'СПб ГБУЗ "Городская поликлиника №19"',
    "172012": 'СПб ГБУЗ "Городская поликлиника № 39"',
    "186268": 'СПб ГБУЗ "Городская поликлиника № 27"',
    "182668": 'СПб ГБУЗ "Городская поликлиника № 28"',
    "182020": 'СПб ГБУЗ "Городская поликлиника № 24"',
    "187564": 'СПб ГБУЗ "Городская поликлиника № 97"',
    "180436": 'СПб ГБУЗ "Городская поликлиника № 99"',
    "178780": 'СПб ГБУЗ "Городская поликлиника № 118"',
    "182452": 'СПб ГБУЗ "Городская поликлиника № 76"',
    "182956": 'СПб ГБУЗ "Городская поликлиника № 95"',
    "172660": 'СПб ГБУЗ "Городская поликлиника № 22"',
    "174244": 'СПб ГБУЗ "Городская поликлиника № 72"',
    "188068": 'СПб ГБУЗ "Городская поликлиника № 120"',
    "189292": 'СПб ГБУЗ "Городская поликлиника № 74"',
    "173092": 'СПб ГБУЗ "Городская поликлиника № 75"',
    "185044": 'СПб ГБУЗ "Городская поликлиника № 21"',
    "182164": 'СПб ГБУЗ "Городская поликлиника № 51"',
    "186412": 'СПб ГБУЗ "Городская поликлиника № 8"',
    "175684": 'СПб ГБУЗ "Городская поликлиника № 25 Невского района"',
    "188212": 'СПб ГБУЗ "Городская поликлиника № 6"',
    "173236": 'СПб ГБУЗ "Городская поликлиника № 87"',
    "183748": 'СПб ГБУЗ "Городская поликлиника № 94 Невского района"',
    "181876": 'СПб ГБУЗ "Городская поликлиника № 100"',
    "187708": 'СПб ГБУЗ "Городская поликлиника № 46"',
    "180220": 'СПб ГБУЗ "Городская поликлиника № 30"',
    "186484": 'СПб ГБУЗ "Городская поликлиника № 32"',
    "174388": 'СПб ГБУЗ "Городская поликлиника № 34"',
    "188932": 'СПб ГБУЗ "Городская поликлиника № 98"',
    "179788": 'СПб ГБУЗ "Городская поликлиника № 111"',
    "176692": 'СПб ГБУЗ "Консультативно-диагностическая поликлиника № 1"',
    "170500": 'СПб ГБУЗ "Городская поликлиника №78"',
    "181228": 'СПб ГБУЗ "Городская поликлиника № 56"',
    "178348": 'СПб ГБУЗ "Городская поликлиника № 44"',
    "183100": 'СПб ГБУЗ "Городская поликлиника № 37"',
    "186052": 'СПб ГАУЗ "Городская поликлиника № 40"',
    "172156": 'СПб ГБУЗ "Клиническая ревматологическая больница №25"',
    "178564": 'СПб ГБУЗ "Центр СПИД и инфекционных заболеваний"',
    "179860": 'СПб ГАУЗ "Городская поликлиника № 81"',
    "185116": 'СПб ГБУЗ "Центр планирования семьи и репродукции"',
    "183172": 'СПб ГБУЗ "Родильный дом №10"',
    "185476": 'СПб ГБУЗ "Городской кожно-венерологический диспансер"',
    "177484": 'СПб ГАУЗ "Поликлиника городская стоматологическая №22"',
    "172228": 'СПб ГБУЗ "Городская стоматологическая поликлиника №33"',
    "186340": 'СПб ГБУЗ "Городская поликлиника № 63"',
    "186628": 'СПб ГБУЗ "Детская городская поликлиника № 11"',
    "181516": 'СПб ГБУЗ "Детская городская поликлиника № 29"',
    "173812": 'СПб ГБУЗ "Детская городская поликлиника № 51"',
    "180292": 'СПб ГБУЗ "Городская поликлиника № 93"',
    "176332": 'СПб ГБУЗ "Детская городская поликлиника №35"',
    "173596": 'СПб ГБУЗ "Детская городская поликлиника № 73"',
    "179572": 'СПб ГБУЗ "Детская поликлиника № 30"',
    "177412": 'СПб ГБУЗ "Детская городская поликлиника № 44"',
    "179212": 'СПб ГБУЗ "Детский городской многопрофильный клинический специализированный центр ВМТ"',
    "174964": 'СПб ГБУЗ "Городская поликлиника № 38"',
    "180724": 'СПб ГБУЗ "Детская городская поликлиника № 7"',
    "183676": 'СПб ГБУЗ "Детская городская поликлиника № 17"',
    "180508": 'СПб ГБУЗ "Детская городская поликлиника № 45"',
    "187060": 'СПб ГБУЗ "Детская городская поликлиника № 62"',
    "172516": 'СПб ГБУЗ "Детская городская поликлиника № 19"',
    "175252": 'СПб ГБУЗ "Детская городская поликлиника № 49"',
    "181300": 'СПб ГБУЗ "Детская городская больница № 22"',
    "172300": 'СПб ГБУЗ "Детская клиническая больница № 5 им Н.Ф. Филатова"',
    "178924": 'СПб ГБУЗ "Детская городская больница Св. Ольги"',
    "731172": "ФГБУ НМИЦ детской травматологии и ортопедии имени Г. И. Турнера МЗ",
    "731181": "ФГБОУ ВО СПб ГПМУ МЗ",
    "731173": "ФГБУ НМИЦ им. В. А. Алмазова МЗ",
    "731166": 'СПб ГБУЗ "Психиатрическая больница №1 им. П.П. Кащенко"',
    "183964": 'СПб ГКУЗ "Городская психиатрическая больница №6 (стационар с диспансером)"',
    "186700": 'СПб ГБУЗ "Городской клинический онкологический диспансер"',
    "187348": 'СПБ ГБУЗ "Городской противотуберкулезный диспансер"',
    "184756": 'СПб ГБУЗ "Городская поликлиника № 62"',
    "177772": 'СПб ГБУЗ "Детская инфекционная больница № 3"',
    "177916": "СПБ ГБУЗ Детский городской многопрофильный клинический центр высоких медицинских технологий им. К.А. Раухфуса",
    "184396": 'СПб ГБУЗ "Детская городская больница N 2 Святой Марии Магдалины"',
    "731179": 'ФГБУ "Санкт-Петербургский научно-исследовательский институт фтизиопульмонологии" Минздрава России',
    "189076": 'ГБУЗ "СПб КНпЦСВМП(о) имени Н.П. Напалкова"',
    "172588": 'СПб ГАУЗ "Городская поликлиника № 83"',
    "187420": 'СПб ГБУЗ "Городская больница № 15"',
    "172732": 'СПб ГБУЗ "Городская многопрофильная больница №2"',
    "174748": 'СПб ГБУЗ "Городская больница №26"',
    "171724": 'СПб ГБУЗ "Городская больница №38 им. Н.А. Семашко"',
    "181948": 'СПб ГБУЗ "Городская больница Святого Великомученика Георгия"',
    "171148": 'СПб ГБУЗ "Городская больница №9"',
    "170644": 'СПб ГБУЗ "Городская Покровская больница"',
    "187852": 'СПб ГБУЗ "Госпиталь для ветеранов войн"',
    "187780": 'СПб ГБУЗ "Городская психиатрическая больница № 7 имени академика И.П.Павлова"',
    "178852": 'СПб ГБУЗ "Родильный дом №1"',
    "185836": 'СПб ГБУЗ "Родильный дом №6 им. проф. В.Ф.Снегирева"',
    "185404": 'СПб ГБУЗ "Городская больница № 33"',
    "185908": 'СПб ГБУЗ "Родильный дом №13"',
    "176260": 'СПб ГБУЗ "Городская больница Святого Праведного Иоанна Кронштадтского"',
    "181084": 'СПб ГБУЗ "Родильный дом № 17"',
    "180580": 'ГБУЗ "Детская стоматологическая поликлиника № 4"',
    "180148": 'СПб ГБУЗ "Городская детская стоматологическая поликлиника № 6"',
    "185188": 'СПб ГБУЗ "Стоматологическая поликлиника №10"',
    "187492": 'СПб ГБУЗ "Стоматологическая поликлиника №11"',
    "184900": 'СПб ГБУЗ "Стоматологическая поликлиника №12"',
    "184684": 'СПб ГБУЗ "Стоматологическая поликлиника №13"',
    "179284": 'СПб ГБУЗ "Стоматологическая поликлиника №15"',
    "188140": 'СПб ГБУЗ "Поликлиника стоматологическая №16"',
    "176116": 'СПб ГБУЗ "Стоматологическая поликлиника №17"',
    "173380": 'СПб ГБУЗ "Стоматологическая поликлиника №18"',
    "172876": 'СПб ГБУЗ "Стоматологическая поликлиника №19" Пушкинского района',
    "178132": 'СПб ГБУЗ "Городская стоматологическая поликлиника № 2"',
    "173164": 'СПб ГБУЗ "Стоматологическая поликлиника №28 Красносельского района"',
    "185764": 'СПб ГБУЗ "Стоматологическая поликлиника № 29"',
    "182596": 'СПб ГБУЗ "Стоматологическая поликлиника №31"',
    "178996": 'СПб ГБУЗ "Стоматологическая поликлиника №32"',
    "183316": 'СПб ГБУЗ "Стоматологическая поликлиника №4"',
    "179140": 'СПб ГБУЗ "Стоматологическая поликлиника №6"',
    "171076": 'СПб ГБУЗ "Стоматологическая поликлиника №8"',
    "181588": 'СПб ГБУЗ "Стоматологическая поликлиника 9"',
    "175468": 'СПб ГБУЗ "Стоматологическая поликлиника №20"',
    "182740": 'СПб ГБУЗ "Детская городская стоматологическая поликлиника № 1"',
    "173308": 'СПБ ГБУЗ "Детская стоматологическая поликлиника №3"',
    "731188": "ФГБОУ ВО СЗГМУ им. И.И. Мечникова Минздрава России",
    "731171": 'ФГБУ НИИ гриппа им. А.А. Смородинцева" Минздрава России',
    "731175": 'ФГБУ "НМИЦ онкологии им. Н.Н. Петрова" Минздрава России',
    "731176": 'ФГБУ "НМИЦ ПН им. В.М. Бехтерева" Минздрава России',
    "731177": 'ФГБУ "РНЦРХТ им. ак. А.М. Гранова" Минздрава России',
    "731178": "ФГБУ НМИЦ травматологии и ортопедии им.Р.Р. Вредена Минздрава России",
    "731174": 'ФГБУ "СПб НИИ ЛОР" Минздрава России',
    "731169": "ФГБОУ ВО ПСПбГМУ им. И.П. Павлова Минздрава России",
    "731164": 'Спб филиал ФГАУ "НМИЦ МНТК "Микрохирургия глаза" им. акад. С.Н. Федорова" Минздрава России',
}


def dolg_fp_ptz_polic():
    SQL = """SELECT
    TO_CHAR(r.BDATE, 'DD.MM.YYYY') AS day,
    a.AGNNAME AS organization,
    a.RN
FROM 
    PARUS.BLTBLVALUES v
    JOIN PARUS.BLTABLESIND si ON v.BLTABLESIND = si.RN
    JOIN PARUS.BALANCEINDEXES i ON si.BALANCEINDEXES = i.RN
    JOIN PARUS.BLTBLROWS ro ON v.PRN = ro.RN
    JOIN PARUS.BLSUBREPORTS s ON ro.PRN = s.RN
    JOIN PARUS.BLREPORTS r ON s.PRN = r.RN
    JOIN PARUS.AGNLIST a ON r.AGENT = a.RN
    JOIN PARUS.BLREPFORMED rd ON r.BLREPFORMED = rd.RN
    JOIN PARUS.BLREPFORM rf ON rd.PRN = rf.RN
WHERE 
    rf.code = 'ФП ПТЗ'
    AND i.CODE = 'ПТ.подр'
    AND r.BDATE BETWEEN (CURRENT_TIMESTAMP - 3) AND (CURRENT_TIMESTAMP + 15)
"""

    DF = parus_sql(SQL)
    if len(DF) == 0:
        return "отчет не найден"

    DAY = DF.at[0, "DAY"]
    mess = (
        f"Список должников Поликлинники за {DAY}: \n"
        + " - "
        + "\n - ".join([v for k, v in stach_dict.items() if k not in DF["RN"].unique()])
    )

    return mess
